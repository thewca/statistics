queries:
  - showPositions: true
    positionTieBreakerIndex: 2
    explanation: The first day of the competition is assumed here and thus the ages might be some days off.
    headers:
      - Event
      - Type
      - Days
      - Result
      - Person
      - Competition
    sqlQuery: |-
      SELECT
          event.name event,
          type,
          datediff(curdate(), c.start_date) days,
          value,
          concat(
              '<a href="https://www.worldcubeassociation.org/persons/',
              personId,
              '">',
              p.name,
              '</a>'
          ),
          concat(
              '<a href="https://www.worldcubeassociation.org/competitions/',
              competitionId,
              '">',
              c.name,
              '</a>'
          )
      FROM
          (
              SELECT
                  eventId,
                  min(best) value,
                  'Single' type
              FROM
                  ConciseSingleResults
              GROUP BY
                  eventId
              UNION
              SELECT
                  eventId,
                  min(average) value,
                  'Average' type
              FROM
                  ConciseAverageResults
              GROUP BY
                  eventId
          ) record,
          Results result,
          Competitions c,
          Events event,
          Persons p
      WHERE
          (
              (
                  type = 'Single'
                  AND result.best = record.value
              )
              OR (
                  type = 'Average'
                  AND result.average = record.value
              )
          )
          AND result.eventId = record.eventId
          AND c.id = result.competitionId
          AND event.id = result.eventId
          AND event.rank < 990
          and personId = p.id
      ORDER BY
          c.start_date,
          type DESC,
          event.rank
      LIMIT
          10
title: Oldest standing world records
groupName: Events
